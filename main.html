
<!DOCTYPE html>
<html lang="si">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>CHALAH MINI BOT</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:'Poppins',sans-serif;
  background:linear-gradient(180deg,#070204,#230203);
  color:#fff;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px;
  overflow:hidden;
}

/* neon bubbles */
.neon-bubbles{position:fixed;inset:0;z-index:0;pointer-events:none}
.neon-bubbles span{
  position:absolute;
  display:block;
  width:12px;height:12px;border-radius:50%;
  background:radial-gradient(circle,#ff4d4d,#7a0000);
  filter:drop-shadow(0 0 12px #ff4d4d);
  opacity:.8;
  animation:rise 8s linear infinite, drift 4s ease-in-out infinite;
}
@keyframes rise{0%{transform:translateY(110vh) scale(.6);opacity:0}30%{opacity:1}100%{transform:translateY(-15vh) scale(1.15);opacity:0}}
@keyframes drift{0%{transform:translateX(0)}50%{transform:translateX(18px)}100%{transform:translateX(0)}}

/* card wrapper */
.wrap{position:relative;z-index:2;width:380px;max-width:95%}
.box{
  position:relative;
  background:linear-gradient(180deg,rgba(40,0,0,0.6),rgba(10,0,0,0.45));
  border-radius:22px;
  padding:100px 22px 26px;
  text-align:center;
  box-shadow:0 15px 40px rgba(255,60,60,0.18),0 0 60px rgba(255,40,40,0.08) inset;
  border:1px solid rgba(255,80,80,0.1);
  transition:transform .5s ease,opacity .45s ease;
}

/* avatar */
.avatar{
  position:absolute;top:-65px;left:50%;
  transform:translateX(-50%);
  width:130px;height:130px;
  border-radius:50%;
  overflow:hidden;
  border:6px solid rgba(255,50,50,0.4);
  box-shadow:0 10px 40px rgba(255,50,50,0.3);
  background:linear-gradient(135deg,#220000,#5a0000);
}
.avatar img{width:100%;height:100%;object-fit:cover;display:block}

h3{color:#ff6b6b;margin-top:6px;text-shadow:0 0 16px rgba(255,90,90,0.35)}
h6{color:#ffbfbf;font-weight:500;margin:6px 0}

.input-container{display:flex;margin-top:12px;gap:0}
.input-container input{
  flex:1;padding:14px 16px;border-radius:12px 0 0 12px;
  border:none;outline:none;background:#120000;color:#fff;
  font-size:16px;border:1px solid rgba(255,255,255,0.05);
  transition:box-shadow .25s,border-color .25s
}
.input-container input:focus{
  box-shadow:0 0 20px rgba(255,70,70,0.35);border-color:#ff4d4d
}
.input-container button{
  padding:14px 16px;border-radius:0 12px 12px 0;
  border:none;background:#ff3333;color:#fff;font-weight:700;
  cursor:pointer;transition:transform .15s,box-shadow .15s;
}
.input-container button:hover{box-shadow:0 0 20px #ff5555;transform:scale(1.05);}
.input-container button:active{transform:translateY(1px)}

.info{margin-top:14px;color:#ffdede;font-weight:600;text-shadow:0 0 8px rgba(255,120,120,0.06)}

.actions{display:flex;gap:12px;justify-content:center;margin-top:18px}
.join-btn{
  background:linear-gradient(180deg,#19c37d,#0ea84f);
  color:#002200;padding:12px 20px;border-radius:14px;border:none;font-weight:800;
  cursor:pointer;box-shadow:0 12px 35px rgba(10,160,90,0.2);
  transition:transform .2s,box-shadow .2s;
}
.join-btn:hover{transform:scale(1.05);box-shadow:0 15px 45px rgba(10,160,90,0.3);}
.ghost-btn{background:transparent;border:1px solid rgba(255,255,255,0.1);padding:10px 12px;border-radius:12px;color:#ffdede;cursor:pointer}
.ghost-btn:hover{background:rgba(255,80,80,0.05)}

.box.hide{transform:translateY(120px) scale(.95);opacity:0}

.counter{
  margin-top:12px;
  font-weight:700;
  color:#4eff8f;
  font-size:18px;
  text-shadow:0 0 12px #4eff8f;
  transition:all .3s ease;
}

/* small screens */
@media(max-width:420px){
  .avatar{width:96px;height:96px;top:-48px}
  .box{padding-top:78px}
}
</style>
</head>
<body>

<div class="neon-bubbles" id="neon-bubbles"></div>

<div class="wrap">
  <div class="box" id="mainBox">
    <div class="avatar">
      <img src="https://files.catbox.moe/letrek.jpg" alt="Avatar">
    </div>

    <h3>CHALAH MD MINI BOT</h3>
    <h6>CREATE BY CHALANA</h6>
    <h6>ðŸ“± Enter your number with country code</h6>

    <div class="input-container" style="margin-top:10px">
      <input id="number" type="tel" placeholder="947422xxxx" inputmode="numeric" pattern="[0-9]*" />
      <button id="submit">Submit</button>
    </div>

    <div class="info" id="pair" style="min-height:28px"></div>
    <div class="counter" id="pairCount">Connected Users: 0</div>

    <div class="actions">
      <button class="join-btn" id="joinBtn">Join Channel</button>
      <button class="ghost-btn" id="clearBtn" title="Clear">Clear</button>
    </div>
  </div>
</div>

<script>
// generate neon bubbles
const container = document.getElementById('neon-bubbles');
for(let i=0;i<36;i++){
  const s=document.createElement('span');
  s.style.left=Math.random()*100+'vw';
  s.style.bottom=Math.random()*20-10+'vh';
  s.style.width=(10+Math.random()*18)+'px';
  s.style.height=s.style.width;
  s.style.animationDuration=(6+Math.random()*6)+'s';
  s.style.animationDelay=(Math.random()*6)+'s';
  container.appendChild(s);
}

// submit number & fetch code
const pair = document.getElementById('pair');
const submit = document.getElementById('submit');
const num = document.getElementById('number');

submit.addEventListener('click', async (e)=>{
  e.preventDefault();
  if(!num.value || num.value.replace(/[^0-9]/g,'').length < 11){
    pair.innerHTML='<span style="color:#ffb3b3;font-weight:700">Invalid or missing number</span>';
    return;
  }
  const number = num.value.replace(/[^0-9]/g,'');
  num.value='+'+number;
  num.style.background='#120000';
  pair.innerHTML='<span style="color:#ffdede;font-weight:700">Please wait...</span>';
  try{
    let res=await fetch(`/code?number=${number}`);
    let data=await res.json();
    let code=data.code || 'Service Unavailable';
    pair.innerHTML=`<div id="copy" style="color:#ffb3b3;font-weight:700;cursor:pointer" onclick="copyCode()"><strong>CODE:</strong> <span style="color:#fff">${code}</span></div>`;
  }catch(err){
    pair.innerHTML='<span style="color:orangered;font-weight:700">Error fetching code</span>';
  }
});

function copyCode(){
  const el=document.getElementById('copy');
  if(!el) return;
  const txt=el.innerText.replace('CODE:','').trim();
  navigator.clipboard?.writeText(txt).then(()=>{
    const old=el.innerHTML;
    el.innerHTML='<strong style="color:lime">COPIED</strong>';
    setTimeout(()=>el.innerHTML=old,700);
  }).catch(()=>{});
}

// clear input
document.getElementById('clearBtn').addEventListener('click',()=>{
  num.value=''; pair.innerHTML=''; num.type='tel'; num.style.background='';
});

// join button
const joinBtn=document.getElementById('joinBtn');
const mainBox=document.getElementById('mainBox');
const channelURL="https://whatsapp.com/channel/0029Vb5OiseHltY10IBkF112/1066";

joinBtn.addEventListener('click',(ev)=>{
  ev.preventDefault();
  mainBox.classList.add('hide');
  setTimeout(()=>{
    const opened=window.open(channelURL,'_blank','noopener,noreferrer');
    if(!opened) window.location.href=channelURL;
  },450);
});

// allow Enter key to submit
num.addEventListener('keydown',(e)=>{
  if(e.key==='Enter') submit.click();
});

// real pair count
const pairCountEl = document.getElementById('pairCount');
async function updatePairCount(){
  try{
    let res = await fetch('/pair-count');
    let data = await res.json();
    pairCountEl.textContent = `Connected Users: ${data.count || 0}`;
  }catch(err){
    console.error('Failed to fetch pair count',err);
  }
}
// initial + periodic update
updatePairCount();
setInterval(updatePairCount,10000);
</script>

</body>
</html>
